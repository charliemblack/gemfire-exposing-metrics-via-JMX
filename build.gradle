ext {
    version = '1.0.0.SNAPSHOT'
    gemfireVersion = '10.1.2'
    micrometerVersion = '1.12.1'
}

repositories {
    mavenCentral()
    maven {
        credentials {
            username "$broadcomUser"
            password "$broadcomPassword"
        }
        url "https://packages.broadcom.com/artifactory/gemfire"
    }
}

description = 'GemFire exposing a bunch of metrics'

apply plugin: 'idea'
apply plugin: 'java'


group = 'demo.gemfire'

dependencies {
    // Mark GemFire as compileOnly (provided by the GemFire environment)
    compileOnly "com.vmware.gemfire:gemfire-core:$gemfireVersion"
    compileOnly "com.vmware.gemfire:gemfire-logging:$gemfireVersion"

    implementation ("io.micrometer:micrometer-registry-jmx:$micrometerVersion"){
        exclude group: 'org.slf4j'
        // Exclude other SLF4J bindings if present
    }
}

// This task copies the runtime dependencies (which excludes compileOnly)
task copyDependencies(type: Copy) {
    // You can change “$buildDir/lib” to another path if you wish.
    from configurations.runtimeClasspath
    into "$buildDir/lib"
}

build.dependsOn copyDependencies
jar.dependsOn copyDependencies
